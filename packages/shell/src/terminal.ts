import { WebdaTerminal } from "@webda/shell";
import { WorkerOutput, WorkerLogLevel } from "@webda/workout";
import * as colors from "colors";

export default class IvoryShieldTerminal extends WebdaTerminal {
  constructor(
    wo: WorkerOutput,
    versions = undefined,
    level: WorkerLogLevel = undefined,
    format: string = undefined,
    tty: boolean = undefined
  ) {
    super(
      wo,
      {
        ivoryshield: { version: "dev" },
        shell: { version: "dev" },
      },
      // Generated with hiptext https://github.com/jart/hiptext
      // Usefull information for build: https://github.com/jart/hiptext/issues/44
      `[0mÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [48;5;237mÂ [48;5;102mÂ [48;5;242mÂ [48;5;234mÂ [0mÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â [48;5;233mÂ [48;5;241mÂ [48;5;230mÂ Â Â Â Â Â Â [48;5;231mÂ Â [48;5;230mÂ Â [48;5;251mÂ [48;5;236mÂ [48;5;232mÂ [0mÂ Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â [48;5;238mÂ [48;5;187mÂ [48;5;230mÂ Â [48;5;231mÂ Â [48;5;230mÂ Â Â Â Â Â Â Â Â Â Â Â Â [48;5;231mÂ Â Â [48;5;230mÂ Â [48;5;145mÂ [48;5;233mÂ [0mÂ Â Â Â Â Â Â 
Â [mÂ [48;5;144mÂ [48;5;223mÂ [48;5;230mÂ [48;5;231mÂ Â [48;5;230mÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [48;5;231mÂ Â Â [48;5;230mÂ [48;5;252mÂ [48;5;245mÂ [0mÂ Â 
Â Â [48;5;230mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â Â Â [48;5;246mÂ [48;5;24mÂ [48;5;23mÂ Â Â [48;5;67mÂ [48;5;74mÂ Â Â Â Â Â [48;5;60mÂ [48;5;24mÂ Â Â Â [48;5;251mÂ [48;5;230mÂ Â Â Â Â Â Â [48;5;231mÂ [48;5;59mÂ [0mÂ Â 
Â Â [48;5;101mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â [48;5;229mÂ [48;5;23mÂ [48;5;24mÂ Â Â [48;5;239mÂ [48;5;67mÂ [48;5;73mÂ [48;5;67mÂ [48;5;73mÂ [48;5;74mÂ Â [48;5;73mÂ [48;5;67mÂ [48;5;74mÂ [48;5;66mÂ [48;5;24mÂ Â Â Â [48;5;60mÂ [48;5;230mÂ Â Â Â Â [48;5;231mÂ [48;5;230mÂ [48;5;233mÂ [0mÂ Â 
Â Â [mÂ [48;5;230mÂ Â Â Â Â Â [48;5;187mÂ [48;5;23mÂ [48;5;24mÂ Â Â Â [48;5;239mÂ [48;5;66mÂ [48;5;67mÂ [48;5;73mÂ [48;5;242mÂ [48;5;66mÂ [48;5;73mÂ [48;5;67mÂ [48;5;66mÂ [48;5;239mÂ [48;5;24mÂ Â Â Â Â [48;5;230mÂ Â Â Â Â [48;5;231mÂ [48;5;247mÂ [0mÂ Â Â 
Â Â Â [48;5;229mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â [48;5;187mÂ [48;5;23mÂ [48;5;24mÂ Â Â [48;5;23mÂ [48;5;60mÂ [48;5;66mÂ [48;5;67mÂ Â Â [48;5;73mÂ Â Â [48;5;66mÂ [48;5;60mÂ [48;5;24mÂ Â Â Â [48;5;23mÂ [48;5;254mÂ [48;5;230mÂ Â Â [48;5;231mÂ Â [48;5;232mÂ [0mÂ Â Â 
Â Â Â [48;5;237mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â [48;5;187mÂ [48;5;24mÂ Â Â Â [48;5;60mÂ [48;5;74mÂ [48;5;67mÂ Â Â [48;5;74mÂ Â [48;5;67mÂ Â [48;5;60mÂ [48;5;24mÂ Â Â Â [48;5;255mÂ [48;5;230mÂ Â Â Â [48;5;231mÂ [48;5;253mÂ [0mÂ Â Â Â 
Â Â Â [48;5;232mÂ [48;5;230mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â Â [48;5;248mÂ [48;5;60mÂ [48;5;24mÂ [48;5;66mÂ [48;5;74mÂ [48;5;73mÂ [48;5;67mÂ Â [48;5;74mÂ Â [48;5;73mÂ [48;5;67mÂ [48;5;66mÂ [48;5;24mÂ [48;5;60mÂ [48;5;251mÂ [48;5;230mÂ Â Â Â Â Â [48;5;231mÂ [48;5;234mÂ [0mÂ Â Â Â 
Â Â Â Â [48;5;144mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â Â Â Â Â [48;5;67mÂ [48;5;73mÂ Â Â [48;5;67mÂ [48;5;73mÂ Â [48;5;67mÂ Â [48;5;109mÂ [48;5;230mÂ Â Â Â Â Â Â Â [48;5;231mÂ [48;5;253mÂ [0mÂ Â Â Â Â 
Â Â Â Â [48;5;232mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â Â Â Â [48;5;187mÂ [48;5;247mÂ [48;5;248mÂ [48;5;67mÂ [48;5;66mÂ [48;5;67mÂ [48;5;74mÂ Â [48;5;103mÂ [48;5;248mÂ [48;5;247mÂ [48;5;230mÂ Â Â Â Â Â Â Â [48;5;231mÂ [48;5;240mÂ [0mÂ Â Â Â Â 
Â Â Â Â Â [48;5;187mÂ [48;5;231mÂ [48;5;229mÂ [48;5;230mÂ Â Â Â Â Â [48;5;249mÂ [48;5;248mÂ [48;5;145mÂ [48;5;230mÂ [48;5;67mÂ Â [48;5;74mÂ [48;5;67mÂ [48;5;230mÂ [48;5;248mÂ Â [48;5;251mÂ [48;5;230mÂ Â Â Â Â Â [48;5;231mÂ [48;5;254mÂ [0mÂ Â Â Â Â Â 
Â Â Â Â Â [48;5;101mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â [48;5;253mÂ [48;5;230mÂ [48;5;253mÂ [48;5;252mÂ [48;5;253mÂ [48;5;230mÂ Â [48;5;67mÂ Â [48;5;73mÂ [48;5;109mÂ [48;5;230mÂ Â [48;5;253mÂ [48;5;188mÂ [48;5;254mÂ [48;5;230mÂ Â Â Â Â [48;5;231mÂ [48;5;245mÂ [0mÂ Â Â Â Â Â 
Â Â Â Â Â Â [48;5;230mÂ Â Â Â Â Â Â Â Â Â Â Â [48;5;103mÂ [48;5;67mÂ [48;5;74mÂ [48;5;152mÂ [48;5;230mÂ Â Â Â Â Â Â Â Â [48;5;231mÂ Â [0mÂ Â Â Â Â Â Â 
Â Â Â Â Â Â [48;5;180mÂ [48;5;231mÂ [48;5;229mÂ [48;5;230mÂ Â Â Â Â Â Â Â Â [48;5;250mÂ [48;5;67mÂ [48;5;74mÂ [48;5;254mÂ [48;5;230mÂ Â Â Â Â Â Â Â Â [48;5;231mÂ [48;5;247mÂ [0mÂ Â Â Â Â Â Â 
Â Â Â Â Â Â [48;5;236mÂ [48;5;229mÂ [48;5;230mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â Â Â Â [48;5;187mÂ [48;5;73mÂ Â [48;5;255mÂ [48;5;230mÂ Â Â Â Â Â [48;5;231mÂ Â [48;5;230mÂ [48;5;243mÂ [0mÂ Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â [48;5;144mÂ [48;5;230mÂ [48;5;231mÂ Â [48;5;230mÂ Â Â Â [48;5;229mÂ [48;5;66mÂ [48;5;67mÂ [48;5;230mÂ Â Â Â [48;5;231mÂ Â [48;5;254mÂ [48;5;237mÂ [0mÂ Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â [48;5;232mÂ [48;5;187mÂ [48;5;230mÂ [48;5;231mÂ [48;5;230mÂ Â Â Â Â [48;5;231mÂ [48;5;230mÂ [48;5;252mÂ [48;5;232mÂ [0mÂ Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [48;5;238mÂ [48;5;229mÂ [48;5;230mÂ Â [48;5;244mÂ [48;5;232mÂ [0mÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
    `.split("\n"),
      level,
      format
    );
    this.progressChars = ["\u287F", "\u28BF", "\u28FB", "\u28FD", "\u28FE", "\u28F7", "\u28EF", "\u28DF"].map((c) =>
      colors.bold(`[38;5;24m${c}\u001b[39m`)
    );
    this.setTitle("IvoryShield");
  }

  getBar(size: number, complete: boolean) {
    if (complete) {
      return "[" + colors.bold("[38;5;24m" + "\u2836".repeat(size) + "\u001b[39m");
    } else {
      return " ".repeat(size) + "]";
    }
  }

  webdaize(str) {
    if (!this.tty) {
      return str;
    }
    return str.replace(/(ivory)(shield)/gi, "[38;5;230m$1[38;5;24m$2\u001b[39m");
  }
}
